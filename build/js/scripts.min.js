"use strict";const MASKED="+7 (___) ___-__-__",body=document.body,navigationMain=document.querySelector(".main-navigation"),navigationToggle=navigationMain.querySelector(".main-navigation__toggle"),linksNavigationMain=navigationMain.querySelectorAll(".main-navigation__link"),linksSlide=document.querySelectorAll(".places-visit__link"),sliderCountries=document.querySelector(".countries__slider"),buttonsSlide=sliderCountries.querySelectorAll(".countries__slider-button"),imagesSlide=sliderCountries.querySelectorAll(".countries__slider-item"),pricesList=document.querySelector(".prices__list"),formQuestions=document.querySelector(".questions__form"),inputTelQuestions=formQuestions.querySelector(".questions__input--tel"),inputEmailQuestions=formQuestions.querySelector(".questions__input--email"),buttonQuestions=formQuestions.querySelector(".button--questions"),overlayPopupBuy=document.querySelector(".modal-buy"),buttonPopupBuyClose=overlayPopupBuy.querySelector(".modal-buy__close"),overlayPopupSuccess=document.querySelector(".modal-success"),buttonPopupSuccessClose=overlayPopupSuccess.querySelector(".modal-success__close"),formBuy=overlayPopupBuy.querySelector(".modal-buy__form"),inputTelModal=formBuy.querySelector(".modal-buy__input--tel"),inputEmailModal=formBuy.querySelector(".modal-buy__input--email"),buttonModal=formBuy.querySelector(".button--modal-buy");console.log();const buttonWatchTour=document.querySelector(".button--travel-europe"),buttonsBuy=document.querySelectorAll("[data-buy]"),scrollSmoothly=e=>{const t=e.getAttribute("href").substring(1);document.getElementById(t).scrollIntoView({behavior:"smooth",block:"start"})};linksNavigationMain.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),scrollSmoothly(e.target),navigationMain.classList.contains("main-navigation--opened")&&closeMenu()}))})),buttonWatchTour.addEventListener("click",(e=>{e.preventDefault(),scrollSmoothly(e.target)})),navigationMain.classList.remove("main-navigation--nojs");const closeMenu=()=>{navigationMain.classList.add("main-navigation--closed"),navigationMain.classList.remove("main-navigation--opened"),body.classList.remove("page-body--no-scroll")},openMenu=()=>{navigationMain.classList.remove("main-navigation--closed"),navigationMain.classList.add("main-navigation--opened"),body.classList.add("page-body--no-scroll")};navigationToggle.addEventListener("click",(()=>{if(navigationMain.classList.contains("main-navigation--closed"))return navigationMain.classList.remove("main-navigation--closed"),navigationMain.classList.add("main-navigation--opened"),void body.classList.add("page-body--no-scroll");closeMenu()})),sliderCountries.classList.remove("countries__slider--nojs");const changeSlide=(e,t)=>{imagesSlide.forEach((e=>{e.classList.contains("countries__slider-item--current")&&e.classList.remove("countries__slider-item--current")})),buttonsSlide.forEach((e=>{e.classList.contains("countries__slider-button--current")&&e.classList.remove("countries__slider-button--current")})),e.classList.add("countries__slider-item--current"),t.classList.add("countries__slider-button--current")};buttonsSlide.forEach(((e,t)=>{e.addEventListener("click",(()=>{changeSlide(imagesSlide[t],e)}))}));const showSlide=(e,t,o)=>{linksSlide.forEach((e=>{e.classList.contains("places-visit__link--curent")&&e.classList.remove("places-visit__link--curent")})),t.classList.add("places-visit__link--curent"),changeSlide(e,o),scrollSmoothly(t)};linksSlide.forEach(((e,t)=>{e.addEventListener("click",(o=>{o.preventDefault(),showSlide(imagesSlide[t],e,buttonsSlide[t])}))}));let isStorageSupport=!0,storageTel="",storageEmail="";const setItemLocalStorage=(e,t)=>{try{storageTel=localStorage.getItem("tel"),storageEmail=localStorage.getItem("email")}catch(e){isStorageSupport=!1}(storageTel||storageEmail)&&(e.value=storageTel||"",t.value=storageEmail||"")};setItemLocalStorage(inputTelQuestions,inputEmailQuestions);const onDocumentEscKeydown=e=>{27===e.keyCode&&(e.preventDefault(),closePopup())},openPopupBuy=()=>{overlayPopupBuy.classList.add("modal-buy__show-overlay"),body.classList.add("page-body--no-scroll"),inputTelModal.focus(),setItemLocalStorage(inputTelModal,inputEmailModal),document.addEventListener("keydown",onDocumentEscKeydown)};buttonsBuy.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),overlayPopupBuy.classList.add("modal-buy__show-overlay"),body.classList.add("page-body--no-scroll"),inputTelModal.focus(),setItemLocalStorage(inputTelModal,inputEmailModal),document.addEventListener("keydown",onDocumentEscKeydown)}))}));const closePopup=()=>{overlayPopupBuy.classList.contains("modal-buy__show-overlay")&&(overlayPopupBuy.classList.remove("modal-buy__show-overlay"),setItemLocalStorage(inputTelQuestions,inputEmailQuestions)),overlayPopupSuccess.classList.contains("modal-success__show-overlay")&&overlayPopupSuccess.classList.remove("modal-success__show-overlay"),body.classList.remove("page-body--no-scroll"),document.removeEventListener("keydown",onDocumentEscKeydown)},onOverlayClick=e=>{e.target.matches("section")&&(e.stopPropagation(),closePopup())},onButtonCloseClick=e=>{e.preventDefault(),closePopup()};buttonPopupBuyClose.addEventListener("click",onButtonCloseClick),buttonPopupSuccessClose.addEventListener("click",onButtonCloseClick),overlayPopupBuy.addEventListener("click",onOverlayClick),overlayPopupSuccess.addEventListener("click",onOverlayClick),formQuestions.addEventListener("submit",(e=>{inputTelQuestions.value&&inputEmailQuestions.value?(overlayPopupSuccess.classList.add("modal-success__show-overlay"),body.classList.add("page-body--no-scroll"),document.addEventListener("keydown",onDocumentEscKeydown),isStorageSupport&&(localStorage.setItem("tel",inputTelQuestions.value),localStorage.setItem("email",inputEmailQuestions.value))):e.preventDefault()})),formBuy.addEventListener("submit",(e=>{inputTelModal.value&&inputEmailModal.value?(overlayPopupSuccess.classList.add("modal-success__show-overlay"),isStorageSupport&&(localStorage.setItem("tel",inputTelModal.value),localStorage.setItem("email",inputEmailModal.value)),overlayPopupBuy.classList.remove("modal-buy__show-overlay")):e.preventDefault()}));const checkMask=e=>{const t=e.key,o=MASKED,s=o.replace(/\D/g,""),a=e.target.value.replace(/\D/g,"");let l=0,n=o.replace(/[_\d]/g,(e=>l<a.length?a.charAt(l++)||s.charAt(l):e));l=n.indexOf("_"),-1!==l&&(n=n.slice(0,l));let i=o.substring(0,e.target.value.length).replace(/_+/g,(e=>`\\d{1,${e.length}}`)).replace(/[+()]/g,"\\$&");i=new RegExp(`^${i}$`),(!i.test(e.target.value)||e.target.value.length<5||t>47&&t<58)&&(e.target.value=n),"blur"===e.type&&e.target.value.length<5&&(e.target.value="")};inputTelQuestions.addEventListener("input",checkMask),inputTelQuestions.addEventListener("focus",checkMask),inputTelQuestions.addEventListener("blur",checkMask),inputTelModal.addEventListener("input",checkMask),inputTelModal.addEventListener("focus",checkMask),inputTelModal.addEventListener("blur",checkMask);const showError=e=>{e.validity.tooShort?e.setCustomValidity(" Введите 10 цифр номера"):e.validity.valueMissing?e.setCustomValidity("Обязательное поле"):e.setCustomValidity("")};buttonQuestions.addEventListener("click",(()=>{showError(inputTelQuestions)})),buttonModal.addEventListener("click",(()=>{showError(inputTelModal)}));